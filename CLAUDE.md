# The HN Arcade

A directory of games discovered from Hacker News Show HN posts, built with Docusaurus.

## Project structure

- `docs/games/` — each game is a markdown file with frontmatter metadata
- `docs/submit.md` — submission instructions pointing to GitHub Issues
- `src/pages/index.tsx` — homepage with hero and CTAs
- `src/pages/newsletter.tsx` — newsletter signup page (Buttondown integration)
- `src/css/custom.css` — HN orange theme overrides
- `src/theme/DocCard/` — swizzled DocCard component with screenshot support
- `static/img/games/` — game screenshots as `<slug>.png` (generated by `npm run screenshot`)
- `docusaurus.config.ts` — site config; docs served at `/games/` via `routeBasePath`
- `sidebars.ts` — auto-generated sidebar from `docs/`
- `.github/workflows/deploy.yml` — deploys to GitHub Pages on push to `main`
- `.github/workflows/create-game-pr.yml` — auto-generates a PR from game submission issues
- `.github/workflows/scrape-hn.yml` — cron job (every 12h) that scrapes HN for game posts and creates issues
- `.github/workflows/update-hn-points.yml` — cron job (daily) that updates HN points for games added in past 14 days
- `.github/ISSUE_TEMPLATE/submit-game.yml` — structured issue form for game submissions
- `scripts/scrape-hn.mjs` — HN scraper script; queries Algolia API for "Show HN" game posts
- `scripts/screenshot-games.mjs` — takes screenshots of all games and updates frontmatter
- `scripts/update-hn-points.mjs` — updates HN points for all games from Algolia API

## Available MCPs
- Playwright

## Adding a game

### Automated (preferred)

Submit a game via the [GitHub Issue form](https://github.com/andrewgy8/hnarcade/issues/new?template=submit-game.yml). The `create-game-pr.yml` workflow will automatically:

1. Parse the issue form fields
2. Generate `docs/games/<slug>.md` from the submitted data
3. Open a PR on branch `add-game/<slug>` that closes the issue on merge
4. Comment on the issue with a link to the PR

Review and merge the PR to publish the game.

### HN Scraper (automatic discovery)

The `scrape-hn.yml` workflow runs every 12 hours and uses `scripts/scrape-hn.mjs` to query the HN Algolia API for recent "Show HN" game posts. It deduplicates against existing games (by HN item ID and normalized play URL) and open issues, then creates `game-submission`-labeled issues for new candidates. Those issues feed into the same `create-game-pr.yml` pipeline above. Scraper-created issues should be reviewed — tags default to `browser, free` and descriptions are minimal.

### Manual

Create a new file in `docs/games/<slug>.md`:

```markdown
---
title: Game Name
tags: [genre, platform, other-tag]
description: One-line description of the game.
screenshot: /img/games/game-name.png
dateAdded: 2026-01-28
submissionMethod: manual
hnId: XXXXXXX
points: 0
---

# Game Name

| | |
|---|---|
| **Author** | [Author Alias](https://author-website.com) |
| **Play** | [domain.com](https://domain.com) |
| **HN Thread** | [Show HN: Game Name](https://news.ycombinator.com/item?id=XXXXXXX) |
| **Source** | [github.com/user/repo](https://github.com/user/repo) |
| **HN Points** | 0 |
| **Date Added** | 2026-01-28 |
| **Tags** | genre, platform, other-tag |

## About

Longer description of the game.
```

**Screenshot field:** The `screenshot` frontmatter field is used to display images on game cards. It can be:
- A local path: `/img/games/game-name.png` (store image in `static/img/games/`)
- An external URL: `https://example.com/screenshot.png`

Games without screenshots will show a placeholder image.

**Auto-generating screenshots:** Run `npm run screenshot` to automatically visit each game's play URL, take a screenshot, save it to `static/img/games/`, and update the frontmatter. Requires Playwright (`npx playwright install chromium` if not installed).

**dateAdded field:** The `dateAdded` frontmatter field tracks when each game was added to HN Arcade. For manually created games, use the current date in YYYY-MM-DD format. The `create-game-pr.yml` workflow automatically adds this field for new submissions.

**sidebar_position field:** This field contains a random number used for shuffled/random ordering of games. It's preserved from the original game order before date-based sorting was implemented.

**submissionMethod field:** Tracks how a game was added to the directory (`scraped` for games discovered via HN scraper, `manual` for user-submitted or manually added games). This field is used internally to track submission sources but is not displayed on the site.

**Sorting options:** The games index page includes toggle buttons that let users sort games by:
- **Most Recent** — sorts by `dateAdded` (newest first)
- **HN Ranking** — sorts by HN `points` (highest first)
- **A-Z** — alphabetical sorting by game title
- **Random** — sorts by `sidebar_position` (shuffled order)

The user's sort preference is saved to localStorage and persists across sessions. Sort mode changes are tracked with Google Analytics using the `sort_games` event.

**HN points tracking:** Each game's HN item ID and points are stored in frontmatter (`hnId`, `points`). The `update-hn-points.yml` workflow runs daily to fetch updated points from the HN Algolia API for games added in the past 14 days and commits changes. New game submissions automatically fetch points when the PR is created.

**Backfilling dates:** Run `npm run backfill-dates` to automatically add `dateAdded` fields to games that are missing them, using git commit history. Add `-- --all` to recalculate all dates, or `-- --dry-run` to preview changes.

Tags should be lowercase. Common tags: `puzzle`, `strategy`, `arcade`, `sandbox`, `simulation`, `rpg`, `platformer`, `browser`, `mobile`, `desktop`, `open-source`, `multiplayer`, `paid`, `free`.

## Commands

- `npm start` — local dev server
- `npm run build` — production build (output in `build/`)
- `npm run serve` — serve the production build locally
- `npm run scrape` — dry-run HN scraper (add `-- --days=7` for wider window, `-- --create-issues` to create GitHub Issues)
- `npm run archive` — interactive prompt to select games from a random past month for newsletter "From the Archives" section (add `-- --month=2022-03` for specific month; supports 'r' to reject non-games)
- `npm run screenshot` — take screenshots of all games missing them (add `-- --all` to overwrite existing, `-- --dry-run` to preview)
- `npm run backfill-dates` — add `dateAdded` to games from git history (add `-- --all` to recalculate all dates, `-- --dry-run` to preview)
- `npm run update-points` — fetch current HN points for all games (add `-- --dry-run` to preview, `-- --all` to force update even if points exist, `-- --recent-days=14` to only update games from past 14 days)
- `npm run fix-pages` — fix game detail pages to remove intro text duplication and add metadata (HN points, date added, tags) to tables
- `npm run clean-descriptions` — clean game descriptions by removing "Show HN:" prefixes, "Discovered via HN scraper" suffixes, and adding submissionMethod field
- `npm run clean-about` — clean About sections in game files by removing "Show HN:" prefixes and "Discovered via HN scraper" suffixes

## Deployment

GitHub Pages via GitHub Actions. Pushes to `main` trigger a build and deploy to `https://hnarcade.com`. The repo Pages setting must use **GitHub Actions** as the source (not "Deploy from a branch").

## Newsletter

The site has a newsletter signup page at `/newsletter` that uses [Buttondown](https://buttondown.email) for email collection. Subscribers receive weekly curated indie games from Hacker News. The signup form posts directly to Buttondown's embed API.

## Key decisions

- Blog is disabled — the site is purely a game directory
- Docs plugin is repurposed as the game catalog (`routeBasePath: 'games'`)
- Game submissions come in via GitHub Issues using a structured form template; a workflow auto-generates a PR from each submission
- The issue form collects an author alias (not real name)
- Tags provide filtering; Docusaurus auto-generates tag index pages at `/games/tags`
- HN scraper uses the Algolia API (no dependencies beyond Node 20 built-in `fetch`); deduplicates by HN item ID and normalized play URL
- Scraper creates issues (not PRs directly) so every game still gets human review before merging
- Screenshot script uses Playwright to visit each game's play URL and capture a 1280x720 PNG
- Screenshots are passed to DocCard via `customProps` using a custom `sidebarItemsGenerator` in `docusaurus.config.ts` (Docusaurus doesn't expose custom frontmatter through `useDocById`)
- Frontmatter fields (`screenshot`, `dateAdded`, `sidebar_position`, `points`, `hnId`) are passed to `customProps` via the `sidebarItemsGenerator` to enable client-side features
- Games index page (`DocCategoryGeneratedIndexPage`) is swizzled to add client-side sorting toggles between "Most Recent" (`dateAdded`), "Popular" (`points`), "A-Z" (alphabetical), and "Random" (`sidebar_position`) modes, with localStorage persistence and Google Analytics event tracking
- HN points are automatically fetched and updated via a scheduled GitHub Action; new game submissions include points at creation time
- Game detail pages follow a consistent format: metadata table immediately after the title (no intro text), with HN points, date added, and tags included in the table; unique content goes in the About section (no duplication of the description)
- Game descriptions are automatically cleaned to remove "Show HN:" prefixes and "Discovered via HN scraper" suffixes for a cleaner presentation
- The `submissionMethod` frontmatter field tracks whether a game was `scraped` (via HN scraper) or `manual` (user-submitted or manually added)
